{
    "name": "Daisy Dev Container",
    "build":{
        "dockerfile": "Dockerfile",
        "context": ".."
    },

    "customizations": {
        "vscode": {
        "extensions": [
            "ms-vscode.cpptools",
            "maruspa.cmake-tools-helper",
            "ms-vscode.cpptools-extension-pack",
            "ms-vscode.cpptools-themes",
            "ms-vscode.cmake-tools",
            "ms-vscode.makefile-tools"
        ]
        }
    },

    // The container needs access to USB devices for programming Daisy boards
    // This will only work on native docker, not docker desktop as that uses virtual machines
    "runArgs": [
        "--privileged",
        "--device=/dev/bus/usb"
    ],

    "mounts": [
        "source=/dev/bus/usb,target=/dev/bus/usb,type=bind"
    ],

    "containerEnv": {
        "UDEV": "1"
    },

    // Clone the daisy examples and libraries and build them
    "postCreateCommand": "git config --global http.sslVerify false && git clone --recursive https://github.com/electro-smith/DaisyExamples.git && git config --global http.sslVerify true && make -C ${containerWorkspaceFolder}/DaisyExamples/libDaisy && make -C ${containerWorkspaceFolder}/DaisyExamples/DaisySP"
}